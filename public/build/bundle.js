var app=function(e){"use strict";function t(){}function n(e){return e()}let o;function i(e){o=e}function s(){if(!o)throw new Error("Function called outside component initialization");return o}function r(e){s().$$.on_mount.push(e)}const a=/[&"]/g,l=/[&<]/g;function h(e,t=!1){const n=String(e),o=t?a:l;o.lastIndex=0;let i="",s=0;for(;o.test(n);){const e=o.lastIndex-1,t=n[e];i+=n.substring(s,e)+("&"===t?"&amp;":'"'===t?"&quot;":"&lt;"),s=e+1}return i+n.substring(s)}function d(e,t){let n="";for(let o=0;o<e.length;o+=1)n+=t(e[o],o);return n}function c(e,t){if(!e||!e.$$render)throw"svelte:component"===t&&(t+=" this={...}"),new Error(`<${t}> is not a valid SSR component. You may need to review your build config to ensure that dependencies are compiled, rather than imported as pre-compiled modules. Otherwise you may need to fix a <${t}>.`);return e}let A;function p(e){function t(t,n,s,r,a){const l=o;i({$$:{on_destroy:A,context:new Map(a||(l?l.$$.context:[])),on_mount:[],before_update:[],after_update:[],callbacks:Object.create(null)}});const h=e(t,n,s,r);return i(l),h}return{render:(e={},{$$slots:o={},context:i=new Map}={})=>{A=[];const s={title:"",head:"",css:new Set},r=t(s,e,{},o,i);return A.forEach(n),{html:r,css:{code:Array.from(s.css).map((e=>e.code)).join("\n"),map:null},head:s.title+s.head}},$$render:t}}function u(e,t,n){if(null==t||n&&!t)return"";return` ${e}${n&&!0===t?"":`="${h(t,!0)}"`}`}const f=[];
/**
     * @license
     * Copyright (c) 2023, Jeff Hlywa (jhlywa@gmail.com)
     * All rights reserved.
     *
     * Redistribution and use in source and binary forms, with or without
     * modification, are permitted provided that the following conditions are met:
     *
     * 1. Redistributions of source code must retain the above copyright notice,
     *    this list of conditions and the following disclaimer.
     * 2. Redistributions in binary form must reproduce the above copyright notice,
     *    this list of conditions and the following disclaimer in the documentation
     *    and/or other materials provided with the distribution.
     *
     * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
     * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
     * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
     * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE
     * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
     * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
     * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
     * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
     * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
     * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
     * POSSIBILITY OF SUCH DAMAGE.
     */
const m="w",g="b",v="p",C="b",_="k",b="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1",k=-1,w={NORMAL:"n",CAPTURE:"c",BIG_PAWN:"b",EP_CAPTURE:"e",PROMOTION:"p",KSIDE_CASTLE:"k",QSIDE_CASTLE:"q"},E={NORMAL:1,CAPTURE:2,BIG_PAWN:4,EP_CAPTURE:8,PROMOTION:16,KSIDE_CASTLE:32,QSIDE_CASTLE:64},y={a8:0,b8:1,c8:2,d8:3,e8:4,f8:5,g8:6,h8:7,a7:16,b7:17,c7:18,d7:19,e7:20,f7:21,g7:22,h7:23,a6:32,b6:33,c6:34,d6:35,e6:36,f6:37,g6:38,h6:39,a5:48,b5:49,c5:50,d5:51,e5:52,f5:53,g5:54,h5:55,a4:64,b4:65,c4:66,d4:67,e4:68,f4:69,g4:70,h4:71,a3:80,b3:81,c3:82,d3:83,e3:84,f3:85,g3:86,h3:87,a2:96,b2:97,c2:98,d2:99,e2:100,f2:101,g2:102,h2:103,a1:112,b1:113,c1:114,d1:115,e1:116,f1:117,g1:118,h1:119},I={b:[16,32,17,15],w:[-16,-32,-17,-15]},x={n:[-18,-33,-31,-14,18,33,31,14],b:[-17,-15,17,15],r:[-16,1,16,-1],q:[-17,-16,-15,1,17,16,15,-1],k:[-17,-16,-15,1,17,16,15,-1]},S=[20,0,0,0,0,0,0,24,0,0,0,0,0,0,20,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,24,24,24,24,24,24,56,0,56,24,24,24,24,24,24,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,20,0,0,0,0,0,0,24,0,0,0,0,0,0,20],M=[17,0,0,0,0,0,0,16,0,0,0,0,0,0,15,0,0,17,0,0,0,0,0,16,0,0,0,0,0,15,0,0,0,0,17,0,0,0,0,16,0,0,0,0,15,0,0,0,0,0,0,17,0,0,0,16,0,0,0,15,0,0,0,0,0,0,0,0,17,0,0,16,0,0,15,0,0,0,0,0,0,0,0,0,0,17,0,16,0,15,0,0,0,0,0,0,0,0,0,0,0,0,17,16,15,0,0,0,0,0,0,0,1,1,1,1,1,1,1,0,-1,-1,-1,-1,-1,-1,-1,0,0,0,0,0,0,0,-15,-16,-17,0,0,0,0,0,0,0,0,0,0,0,0,-15,0,-16,0,-17,0,0,0,0,0,0,0,0,0,0,-15,0,0,-16,0,0,-17,0,0,0,0,0,0,0,0,-15,0,0,0,-16,0,0,0,-17,0,0,0,0,0,0,-15,0,0,0,0,-16,0,0,0,0,-17,0,0,0,0,-15,0,0,0,0,0,-16,0,0,0,0,0,-17,0,0,-15,0,0,0,0,0,0,-16,0,0,0,0,0,0,-17],N={p:1,n:2,b:4,r:8,q:16,k:32},P=["n",C,"r","q"],B=7,R=0,K={w:[{square:y.a1,flag:E.QSIDE_CASTLE},{square:y.h1,flag:E.KSIDE_CASTLE}],b:[{square:y.a8,flag:E.QSIDE_CASTLE},{square:y.h8,flag:E.KSIDE_CASTLE}]},G={b:1,w:6},q=["1-0","0-1","1/2-1/2","*"];function $(e){return e>>4}function T(e){return 15&e}function L(e){return-1!=="0123456789".indexOf(e)}function O(e){const t=T(e),n=$(e);return"abcdefgh".substring(t,t+1)+"87654321".substring(n,n+1)}function U(e){return e===m?g:m}function F(e,t,n,o,i,s=undefined,r=E.NORMAL){const a=$(o);if(i!==v||a!==B&&a!==R)e.push({color:t,from:n,to:o,piece:i,captured:s,flags:r});else for(let a=0;a<P.length;a++){const l=P[a];e.push({color:t,from:n,to:o,piece:i,captured:s,promotion:l,flags:r|E.PROMOTION})}}function D(e){let t=e.charAt(0);if(t>="a"&&t<="h"){if(e.match(/[a-h]\d.*[a-h]\d/))return;return v}return t=t.toLowerCase(),"o"===t?_:t}function j(e){return e.replace(/=/,"").replace(/[+#]?[?!]*$/,"")}class Q{constructor(e=b){this._board=new Array(128),this._turn=m,this._header={},this._kings={w:k,b:k},this._epSquare=-1,this._halfMoves=0,this._moveNumber=0,this._history=[],this._comments={},this._castling={w:0,b:0},this.load(e)}clear(e=!1){this._board=new Array(128),this._kings={w:k,b:k},this._turn=m,this._castling={w:0,b:0},this._epSquare=k,this._halfMoves=0,this._moveNumber=1,this._history=[],this._comments={},this._header=e?this._header:{},this._updateSetup(this.fen())}load(e,t=!1){let n=e.split(/\s+/);if(n.length>=2&&n.length<6){const t=["-","-","0","1"];e=n.concat(t.slice(-(6-n.length))).join(" ")}n=e.split(/\s+/);const{ok:o,error:i}=function(e){const t=e.split(/\s+/);if(6!==t.length)return{ok:!1,error:"Invalid FEN: must contain six space-delimited fields"};const n=parseInt(t[5],10);if(isNaN(n)||n<=0)return{ok:!1,error:"Invalid FEN: move number must be a positive integer"};const o=parseInt(t[4],10);if(isNaN(o)||o<0)return{ok:!1,error:"Invalid FEN: half move counter number must be a non-negative integer"};if(!/^(-|[abcdefgh][36])$/.test(t[3]))return{ok:!1,error:"Invalid FEN: en-passant square is invalid"};if(/[^kKqQ-]/.test(t[2]))return{ok:!1,error:"Invalid FEN: castling availability is invalid"};if(!/^(w|b)$/.test(t[1]))return{ok:!1,error:"Invalid FEN: side-to-move is invalid"};const i=t[0].split("/");if(8!==i.length)return{ok:!1,error:"Invalid FEN: piece data does not contain 8 '/'-delimited rows"};for(let e=0;e<i.length;e++){let t=0,n=!1;for(let o=0;o<i[e].length;o++)if(L(i[e][o])){if(n)return{ok:!1,error:"Invalid FEN: piece data is invalid (consecutive number)"};t+=parseInt(i[e][o],10),n=!0}else{if(!/^[prnbqkPRNBQK]$/.test(i[e][o]))return{ok:!1,error:"Invalid FEN: piece data is invalid (invalid piece)"};t+=1,n=!1}if(8!==t)return{ok:!1,error:"Invalid FEN: piece data is invalid (too many squares in rank)"}}if("3"==t[3][1]&&"w"==t[1]||"6"==t[3][1]&&"b"==t[1])return{ok:!1,error:"Invalid FEN: illegal en-passant square"};const s=[{color:"white",regex:/K/g},{color:"black",regex:/k/g}];for(const{color:e,regex:n}of s){if(!n.test(t[0]))return{ok:!1,error:`Invalid FEN: missing ${e} king`};if((t[0].match(n)||[]).length>1)return{ok:!1,error:`Invalid FEN: too many ${e} kings`}}return{ok:!0}}(e);if(!o)throw new Error(i);const s=n[0];let r=0;this.clear(t);for(let e=0;e<s.length;e++){const t=s.charAt(e);if("/"===t)r+=8;else if(L(t))r+=parseInt(t,10);else{const e=t<"a"?m:g;this.put({type:t.toLowerCase(),color:e},O(r)),r++}}this._turn=n[1],n[2].indexOf("K")>-1&&(this._castling.w|=E.KSIDE_CASTLE),n[2].indexOf("Q")>-1&&(this._castling.w|=E.QSIDE_CASTLE),n[2].indexOf("k")>-1&&(this._castling.b|=E.KSIDE_CASTLE),n[2].indexOf("q")>-1&&(this._castling.b|=E.QSIDE_CASTLE),this._epSquare="-"===n[3]?k:y[n[3]],this._halfMoves=parseInt(n[4],10),this._moveNumber=parseInt(n[5],10),this._updateSetup(this.fen())}fen(){var e,t;let n=0,o="";for(let e=y.a8;e<=y.h1;e++){if(this._board[e]){n>0&&(o+=n,n=0);const{color:t,type:i}=this._board[e];o+=t===m?i.toUpperCase():i.toLowerCase()}else n++;e+1&136&&(n>0&&(o+=n),e!==y.h1&&(o+="/"),n=0,e+=8)}let i="";this._castling[m]&E.KSIDE_CASTLE&&(i+="K"),this._castling[m]&E.QSIDE_CASTLE&&(i+="Q"),this._castling[g]&E.KSIDE_CASTLE&&(i+="k"),this._castling[g]&E.QSIDE_CASTLE&&(i+="q"),i=i||"-";let s="-";if(this._epSquare!==k){const n=this._epSquare+(this._turn===m?16:-16),o=[n+1,n-1];for(const n of o){if(136&n)continue;const o=this._turn;if((null===(e=this._board[n])||void 0===e?void 0:e.color)===o&&(null===(t=this._board[n])||void 0===t?void 0:t.type)===v){this._makeMove({color:o,from:n,to:this._epSquare,piece:v,captured:v,flags:E.EP_CAPTURE});const e=!this._isKingAttacked(o);if(this._undoMove(),e){s=O(this._epSquare);break}}}}return[o,this._turn,i,s,this._halfMoves,this._moveNumber].join(" ")}_updateSetup(e){this._history.length>0||(e!==b?(this._header.SetUp="1",this._header.FEN=e):(delete this._header.SetUp,delete this._header.FEN))}reset(){this.load(b)}get(e){return this._board[y[e]]||!1}put({type:e,color:t},n){if(-1==="pnbrqkPNBRQK".indexOf(e.toLowerCase()))return!1;if(!(n in y))return!1;const o=y[n];return(e!=_||this._kings[t]==k||this._kings[t]==o)&&(this._board[o]={type:e,color:t},e===_&&(this._kings[t]=o),this._updateSetup(this.fen()),!0)}remove(e){const t=this.get(e);return delete this._board[y[e]],t&&t.type===_&&(this._kings[t.color]=k),this._updateSetup(this.fen()),t}_attacked(e,t){for(let n=y.a8;n<=y.h1;n++){if(136&n){n+=7;continue}if(void 0===this._board[n]||this._board[n].color!==e)continue;const o=this._board[n],i=n-t;if(0===i)continue;const s=i+119;if(S[s]&N[o.type]){if(o.type===v){if(i>0){if(o.color===m)return!0}else if(o.color===g)return!0;continue}if("n"===o.type||"k"===o.type)return!0;const e=M[s];let r=n+e,a=!1;for(;r!==t;){if(null!=this._board[r]){a=!0;break}r+=e}if(!a)return!0}}return!1}_isKingAttacked(e){return this._attacked(U(e),this._kings[e])}isAttacked(e,t){return this._attacked(t,y[e])}isCheck(){return this._isKingAttacked(this._turn)}inCheck(){return this.isCheck()}isCheckmate(){return this.isCheck()&&0===this._moves().length}isStalemate(){return!this.isCheck()&&0===this._moves().length}isInsufficientMaterial(){const e={b:0,n:0,r:0,q:0,k:0,p:0},t=[];let n=0,o=0;for(let i=y.a8;i<=y.h1;i++){if(o=(o+1)%2,136&i){i+=7;continue}const s=this._board[i];s&&(e[s.type]=s.type in e?e[s.type]+1:1,s.type===C&&t.push(o),n++)}if(2===n)return!0;if(3===n&&(1===e[C]||1===e.n))return!0;if(n===e[C]+2){let e=0;const n=t.length;for(let o=0;o<n;o++)e+=t[o];if(0===e||e===n)return!0}return!1}isThreefoldRepetition(){const e=[],t={};let n=!1;for(;;){const t=this._undoMove();if(!t)break;e.push(t)}for(;;){const o=this.fen().split(" ").slice(0,4).join(" ");t[o]=o in t?t[o]+1:1,t[o]>=3&&(n=!0);const i=e.pop();if(!i)break;this._makeMove(i)}return n}isDraw(){return this._halfMoves>=100||this.isStalemate()||this.isInsufficientMaterial()||this.isThreefoldRepetition()}isGameOver(){return this.isCheckmate()||this.isStalemate()||this.isDraw()}moves({verbose:e=!1,square:t,piece:n}={}){const o=this._moves({square:t,piece:n});return e?o.map((e=>this._makePretty(e))):o.map((e=>this._moveToSan(e,o)))}_moves({legal:e=!0,piece:t,square:n}={}){var o;const i=n?n.toLowerCase():void 0,s=null==t?void 0:t.toLowerCase(),r=[],a=this._turn,l=U(a);let h=y.a8,d=y.h1,c=!1;if(i){if(!(i in y))return[];h=d=y[i],c=!0}for(let e=h;e<=d;e++){if(136&e){e+=7;continue}if(!this._board[e]||this._board[e].color===l)continue;const{type:t}=this._board[e];let n;if(t===v){if(s&&s!==t)continue;n=e+I[a][0],this._board[n]||(F(r,a,e,n,v),n=e+I[a][1],G[a]!==$(e)||this._board[n]||F(r,a,e,n,v,void 0,E.BIG_PAWN));for(let t=2;t<4;t++)n=e+I[a][t],136&n||((null===(o=this._board[n])||void 0===o?void 0:o.color)===l?F(r,a,e,n,v,this._board[n].type,E.CAPTURE):n===this._epSquare&&F(r,a,e,n,v,v,E.EP_CAPTURE))}else{if(s&&s!==t)continue;for(let o=0,i=x[t].length;o<i;o++){const i=x[t][o];for(n=e;n+=i,!(136&n);){if(this._board[n]){if(this._board[n].color===a)break;F(r,a,e,n,t,this._board[n].type,E.CAPTURE);break}if(F(r,a,e,n,t),"n"===t||t===_)break}}}}if(!(void 0!==s&&s!==_||c&&d!==this._kings[a])){if(this._castling[a]&E.KSIDE_CASTLE){const e=this._kings[a],t=e+2;this._board[e+1]||this._board[t]||this._attacked(l,this._kings[a])||this._attacked(l,e+1)||this._attacked(l,t)||F(r,a,this._kings[a],t,_,void 0,E.KSIDE_CASTLE)}if(this._castling[a]&E.QSIDE_CASTLE){const e=this._kings[a],t=e-2;this._board[e-1]||this._board[e-2]||this._board[e-3]||this._attacked(l,this._kings[a])||this._attacked(l,e-1)||this._attacked(l,t)||F(r,a,this._kings[a],t,_,void 0,E.QSIDE_CASTLE)}}if(!e)return r;const A=[];for(let e=0,t=r.length;e<t;e++)this._makeMove(r[e]),this._isKingAttacked(a)||A.push(r[e]),this._undoMove();return A}move(e,{strict:t=!1}={}){let n=null;if("string"==typeof e)n=this._moveFromSan(e,t);else if("object"==typeof e){const t=this._moves();for(let o=0,i=t.length;o<i;o++)if(e.from===O(t[o].from)&&e.to===O(t[o].to)&&(!("promotion"in t[o])||e.promotion===t[o].promotion)){n=t[o];break}}if(!n)throw"string"==typeof e?new Error(`Invalid move: ${e}`):new Error(`Invalid move: ${JSON.stringify(e)}`);const o=this._makePretty(n);return this._makeMove(n),o}_push(e){this._history.push({move:e,kings:{b:this._kings.b,w:this._kings.w},turn:this._turn,castling:{b:this._castling.b,w:this._castling.w},epSquare:this._epSquare,halfMoves:this._halfMoves,moveNumber:this._moveNumber})}_makeMove(e){const t=this._turn,n=U(t);if(this._push(e),this._board[e.to]=this._board[e.from],delete this._board[e.from],e.flags&E.EP_CAPTURE&&(this._turn===g?delete this._board[e.to-16]:delete this._board[e.to+16]),e.promotion&&(this._board[e.to]={type:e.promotion,color:t}),this._board[e.to].type===_){if(this._kings[t]=e.to,e.flags&E.KSIDE_CASTLE){const t=e.to-1,n=e.to+1;this._board[t]=this._board[n],delete this._board[n]}else if(e.flags&E.QSIDE_CASTLE){const t=e.to+1,n=e.to-2;this._board[t]=this._board[n],delete this._board[n]}this._castling[t]=0}if(this._castling[t])for(let n=0,o=K[t].length;n<o;n++)if(e.from===K[t][n].square&&this._castling[t]&K[t][n].flag){this._castling[t]^=K[t][n].flag;break}if(this._castling[n])for(let t=0,o=K[n].length;t<o;t++)if(e.to===K[n][t].square&&this._castling[n]&K[n][t].flag){this._castling[n]^=K[n][t].flag;break}e.flags&E.BIG_PAWN?this._epSquare=t===g?e.to-16:e.to+16:this._epSquare=k,e.piece===v||e.flags&(E.CAPTURE|E.EP_CAPTURE)?this._halfMoves=0:this._halfMoves++,t===g&&this._moveNumber++,this._turn=n}undo(){const e=this._undoMove();return e?this._makePretty(e):null}_undoMove(){const e=this._history.pop();if(void 0===e)return null;const t=e.move;this._kings=e.kings,this._turn=e.turn,this._castling=e.castling,this._epSquare=e.epSquare,this._halfMoves=e.halfMoves,this._moveNumber=e.moveNumber;const n=this._turn,o=U(n);if(this._board[t.from]=this._board[t.to],this._board[t.from].type=t.piece,delete this._board[t.to],t.captured)if(t.flags&E.EP_CAPTURE){let e;e=n===g?t.to-16:t.to+16,this._board[e]={type:v,color:o}}else this._board[t.to]={type:t.captured,color:o};if(t.flags&(E.KSIDE_CASTLE|E.QSIDE_CASTLE)){let e,n;t.flags&E.KSIDE_CASTLE?(e=t.to+1,n=t.to-1):(e=t.to-2,n=t.to+1),this._board[e]=this._board[n],delete this._board[n]}return t}pgn({newline:e="\n",maxWidth:t=0}={}){const n=[];let o=!1;for(const t in this._header)n.push("["+t+' "'+this._header[t]+'"]'+e),o=!0;o&&this._history.length&&n.push(e);const i=e=>{const t=this._comments[this.fen()];if(void 0!==t){e=`${e}${e.length>0?" ":""}{${t}}`}return e},s=[];for(;this._history.length>0;)s.push(this._undoMove());const r=[];let a="";for(0===s.length&&r.push(i(""));s.length>0;){a=i(a);const e=s.pop();if(!e)break;if(this._history.length||"b"!==e.color)"w"===e.color&&(a.length&&r.push(a),a=this._moveNumber+".");else{const e=`${this._moveNumber}. ...`;a=a?`${a} ${e}`:e}a=a+" "+this._moveToSan(e,this._moves({legal:!0})),this._makeMove(e)}if(a.length&&r.push(i(a)),void 0!==this._header.Result&&r.push(this._header.Result),0===t)return n.join("")+r.join(" ");const l=function(){return n.length>0&&" "===n[n.length-1]&&(n.pop(),!0)},h=function(o,i){for(const s of i.split(" "))if(s){if(o+s.length>t){for(;l();)o--;n.push(e),o=0}n.push(s),o+=s.length,n.push(" "),o++}return l()&&o--,o};let d=0;for(let o=0;o<r.length;o++)d+r[o].length>t&&r[o].includes("{")?d=h(d,r[o]):(d+r[o].length>t&&0!==o?(" "===n[n.length-1]&&n.pop(),n.push(e),d=0):0!==o&&(n.push(" "),d++),n.push(r[o]),d+=r[o].length);return n.join("")}header(...e){for(let t=0;t<e.length;t+=2)"string"==typeof e[t]&&"string"==typeof e[t+1]&&(this._header[e[t]]=e[t+1]);return this._header}loadPgn(e,{strict:t=!1,newlineChar:n="\r?\n"}={}){function o(e){return e.replace(/\\/g,"\\")}e=e.trim();const i=new RegExp("^(\\[((?:"+o(n)+")|.)*\\])((?:\\s*"+o(n)+"){2}|(?:\\s*"+o(n)+")*$)").exec(e),s=i&&i.length>=2?i[1]:"";this.reset();const r=function(e){const t={},i=e.split(new RegExp(o(n)));let s="",r="";for(let e=0;e<i.length;e++){const n=/^\s*\[\s*([A-Za-z]+)\s*"(.*)"\s*\]\s*$/;s=i[e].replace(n,"$1"),r=i[e].replace(n,"$2"),s.trim().length>0&&(t[s]=r)}return t}(s);let a="";for(const e in r)"fen"===e.toLowerCase()&&(a=r[e]),this.header(e,r[e]);if(t){if("1"===r.SetUp){if(!("FEN"in r))throw new Error("Invalid PGN: FEN tag must be supplied with SetUp tag");this.load(r.FEN,!0)}}else a&&this.load(a,!0);const l=function(e){return`{${function(e){return Array.from(e).map((function(e){return e.charCodeAt(0)<128?e.charCodeAt(0).toString(16):encodeURIComponent(e).replace(/%/g,"").toLowerCase()})).join("")}((e=e.replace(new RegExp(o(n),"g")," ")).slice(1,e.length-1))}}`},h=function(e){if(e.startsWith("{")&&e.endsWith("}"))return function(e){return 0==e.length?"":decodeURIComponent("%"+(e.match(/.{1,2}/g)||[]).join("%"))}(e.slice(1,e.length-1))};let d=e.replace(s,"").replace(new RegExp(`({[^}]*})+?|;([^${o(n)}]*)`,"g"),(function(e,t,n){return void 0!==t?l(t):" "+l(`{${n.slice(1)}}`)})).replace(new RegExp(o(n),"g")," ");const c=/(\([^()]+\))+?/g;for(;c.test(d);)d=d.replace(c,"");d=d.replace(/\d+\.(\.\.)?/g,""),d=d.replace(/\.\.\./g,""),d=d.replace(/\$\d+/g,"");let A=d.trim().split(new RegExp(/\s+/));A=A.filter((e=>""!==e));let p="";for(let e=0;e<A.length;e++){const n=h(A[e]);if(void 0!==n){this._comments[this.fen()]=n;continue}const o=this._moveFromSan(A[e],t);if(null==o){if(!(q.indexOf(A[e])>-1))throw new Error(`Invalid move in PGN: ${A[e]}`);p=A[e]}else p="",this._makeMove(o)}p&&Object.keys(this._header).length&&!this._header.Result&&this.header("Result",p)}_moveToSan(e,t){let n="";if(e.flags&E.KSIDE_CASTLE)n="O-O";else if(e.flags&E.QSIDE_CASTLE)n="O-O-O";else{if(e.piece!==v){const o=function(e,t){const n=e.from,o=e.to,i=e.piece;let s=0,r=0,a=0;for(let e=0,l=t.length;e<l;e++){const l=t[e].from,h=t[e].to;i===t[e].piece&&n!==l&&o===h&&(s++,$(n)===$(l)&&r++,T(n)===T(l)&&a++)}return s>0?r>0&&a>0?O(n):a>0?O(n).charAt(1):O(n).charAt(0):""}(e,t);n+=e.piece.toUpperCase()+o}e.flags&(E.CAPTURE|E.EP_CAPTURE)&&(e.piece===v&&(n+=O(e.from)[0]),n+="x"),n+=O(e.to),e.promotion&&(n+="="+e.promotion.toUpperCase())}return this._makeMove(e),this.isCheck()&&(this.isCheckmate()?n+="#":n+="+"),this._undoMove(),n}_moveFromSan(e,t=!1){const n=j(e);let o,i,s,r,a,l=D(n),h=this._moves({legal:!0,piece:l});for(let e=0,t=h.length;e<t;e++)if(n===j(this._moveToSan(h[e],h)))return h[e];if(t)return null;let d=!1;i=n.match(/([pnbrqkPNBRQK])?([a-h][1-8])x?-?([a-h][1-8])([qrbnQRBN])?/),i?(o=i[1],s=i[2],r=i[3],a=i[4],1==s.length&&(d=!0)):(i=n.match(/([pnbrqkPNBRQK])?([a-h]?[1-8]?)x?-?([a-h][1-8])([qrbnQRBN])?/),i&&(o=i[1],s=i[2],r=i[3],a=i[4],1==s.length&&(d=!0))),l=D(n),h=this._moves({legal:!0,piece:o||l});for(let e=0,t=h.length;e<t;e++)if(s&&r){if(!(o&&o.toLowerCase()!=h[e].piece||y[s]!=h[e].from||y[r]!=h[e].to||a&&a.toLowerCase()!=h[e].promotion))return h[e];if(d){const t=O(h[e].from);if(!(o&&o.toLowerCase()!=h[e].piece||y[r]!=h[e].to||s!=t[0]&&s!=t[1]||a&&a.toLowerCase()!=h[e].promotion))return h[e]}}return null}ascii(){let e="   +------------------------+\n";for(let t=y.a8;t<=y.h1;t++){if(0===T(t)&&(e+=" "+"87654321"[$(t)]+" |"),this._board[t]){const n=this._board[t].type;e+=" "+(this._board[t].color===m?n.toUpperCase():n.toLowerCase())+" "}else e+=" . ";t+1&136&&(e+="|\n",t+=8)}return e+="   +------------------------+\n",e+="     a  b  c  d  e  f  g  h",e}perft(e){const t=this._moves({legal:!1});let n=0;const o=this._turn;for(let i=0,s=t.length;i<s;i++)this._makeMove(t[i]),this._isKingAttacked(o)||(e-1>0?n+=this.perft(e-1):n++),this._undoMove();return n}_makePretty(e){const{color:t,piece:n,from:o,to:i,flags:s,captured:r,promotion:a}=e;let l="";for(const e in E)E[e]&s&&(l+=w[e]);const h=O(o),d=O(i),c={color:t,piece:n,from:h,to:d,san:this._moveToSan(e,this._moves({legal:!0})),flags:l,lan:h+d,before:this.fen(),after:""};return this._makeMove(e),c.after=this.fen(),this._undoMove(),r&&(c.captured=r),a&&(c.promotion=a,c.lan+=a),c}turn(){return this._turn}board(){const e=[];let t=[];for(let n=y.a8;n<=y.h1;n++)null==this._board[n]?t.push(null):t.push({square:O(n),type:this._board[n].type,color:this._board[n].color}),n+1&136&&(e.push(t),t=[],n+=8);return e}squareColor(e){if(e in y){const t=y[e];return($(t)+T(t))%2==0?"light":"dark"}return null}history({verbose:e=!1}={}){const t=[],n=[];for(;this._history.length>0;)t.push(this._undoMove());for(;;){const o=t.pop();if(!o)break;e?n.push(this._makePretty(o)):n.push(this._moveToSan(o,this._moves())),this._makeMove(o)}return n}_pruneComments(){const e=[],t={},n=e=>{e in this._comments&&(t[e]=this._comments[e])};for(;this._history.length>0;)e.push(this._undoMove());for(n(this.fen());;){const t=e.pop();if(!t)break;this._makeMove(t),n(this.fen())}this._comments=t}getComment(){return this._comments[this.fen()]}setComment(e){this._comments[this.fen()]=e.replace("{","[").replace("}","]")}deleteComment(){const e=this._comments[this.fen()];return delete this._comments[this.fen()],e}getComments(){return this._pruneComments(),Object.keys(this._comments).map((e=>({fen:e,comment:this._comments[e]})))}deleteComments(){return this._pruneComments(),Object.keys(this._comments).map((e=>{const t=this._comments[e];return delete this._comments[e],{fen:e,comment:t}}))}}const z={code:".move-list.svelte-1pf9wc2{display:grid;grid-template-columns:repeat(2, 1fr);gap:8px;width:100%;max-width:180px;max-height:370px;overflow-y:auto;padding:8px;border:1px solid #ccc;background-color:#f8f8f8}.almost-invisible.svelte-1pf9wc2{background-color:rgba(255, 255, 255, 0.1);border:1px solid rgba(255, 255, 255, 0.2);padding:5px 10px;font-size:14px;cursor:pointer}.almost-invisible-on.svelte-1pf9wc2{background-color:#e8e8e8;border:1px solid rgba(255, 255, 255, 0.2);padding:5px 10px;font-size:14px;cursor:pointer}.almost-invisible.svelte-1pf9wc2:hover{background-color:#e8e8e8}",map:'{"version":3,"file":"MoveViewer.svelte","sources":["MoveViewer.svelte"],"sourcesContent":["<script>\\n  import { writable } from \\"svelte/store\\";\\n  import { Chess } from \\"chess.js\\";\\n  import { onMount, afterUpdate } from \'svelte\';\\n\\n  let chess = new Chess();\\n\\n  export let history = [];\\n  export let handleMove;\\n  export let handleUndo;\\n  export let handleRedo;\\n  export let currentIndex;\\n  \\n  function displayMove(move,index) { \\n    if (index % 2 == 0) {\\n      return parseInt(index/2)+1 + \\". \\" + move.san;\\n    }\\n    else{\\n      return move.san;\\n    }\\n  }\\n  let moveRefs = [];\\n\\n  onMount(() => {\\n    window.addEventListener(\'keydown\', handleGlobalKeyDown);\\n\\n    scrollToSelectedMove();\\n  });\\n\\n  afterUpdate(() => {\\n    window.removeEventListener(\'keydown\', handleGlobalKeyDown);\\n\\n    scrollToSelectedMove();\\n  });\\n\\n  function handleGlobalKeyDown(event) {\\n    if (event.key === \'ArrowLeft\') {\\n      handleUndo();\\n    }\\n    if (event.key === \'ArrowRight\') {\\n      handleRedo();\\n    }\\n  }\\n\\n  function scrollToSelectedMove() {\\n    if (moveRefs[currentIndex]) {\\n      moveRefs[currentIndex].scrollIntoView({\\n        behavior: \'smooth\',\\n        block: \'center\',\\n        inline: \'nearest\',\\n      });\\n    }\\n  }\\n  \\n<\/script>\\n\\n<style>\\n  .move-list {\\n    display: grid;\\n    grid-template-columns: repeat(2, 1fr);\\n    gap: 8px;\\n    width: 100%;\\n    max-width: 180px;\\n    max-height: 370px;\\n    overflow-y: auto;\\n    padding: 8px;\\n    border: 1px solid #ccc;\\n    background-color: #f8f8f8;\\n  }\\n\\n  \\n  .almost-invisible {\\n    background-color: rgba(255, 255, 255, 0.1); /* adjust opacity as needed */\\n    border: 1px solid rgba(255, 255, 255, 0.2); /* adjust opacity as needed */\\n    padding: 5px 10px;\\n    font-size: 14px;\\n    cursor: pointer;\\n  }\\n  .almost-invisible-on {\\n    background-color: #e8e8e8;\\n    border: 1px solid rgba(255, 255, 255, 0.2); /* adjust opacity as needed */\\n    padding: 5px 10px;\\n    font-size: 14px;\\n    cursor: pointer;\\n  }\\n  .almost-invisible:hover {\\n    background-color: #e8e8e8;\\n  }\\n\\n</style>\\n\\n<div>\\n  {#if history != []}\\n    <div class=\\"move-list\\">\\n      {#each history as move, index}\\n          {#if index == currentIndex}\\n            <button bind:this={moveRefs[index]} class=\\"almost-invisible-on\\" on:click={() => { handleMove(index, history); scrollToSelectedMove(); }}>{displayMove(move, index)} </button>\\n          {:else}\\n            <button bind:this={moveRefs[index]} class=\\"almost-invisible\\" on:click={() => { handleMove(index, history); scrollToSelectedMove(); }}>{displayMove(move, index)} </button>\\n          {/if}\\n      {/each}\\n    </div>\\n  {/if}\\n  <button on:click={handleUndo}> prev </button>\\n  <button on:click={handleRedo}> next</button>\\n</div>\\n"],"names":[],"mappings":"AAyDE,yBAAW,CACT,OAAO,CAAE,IAAI,CACb,qBAAqB,CAAE,OAAO,CAAC,CAAC,CAAC,GAAG,CAAC,CACrC,GAAG,CAAE,GAAG,CACR,KAAK,CAAE,IAAI,CACX,SAAS,CAAE,KAAK,CAChB,UAAU,CAAE,KAAK,CACjB,UAAU,CAAE,IAAI,CAChB,OAAO,CAAE,GAAG,CACZ,MAAM,CAAE,GAAG,CAAC,KAAK,CAAC,IAAI,CACtB,gBAAgB,CAAE,OACpB,CAGA,gCAAkB,CAChB,gBAAgB,CAAE,KAAK,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,CAC1C,MAAM,CAAE,GAAG,CAAC,KAAK,CAAC,KAAK,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,CAC1C,OAAO,CAAE,GAAG,CAAC,IAAI,CACjB,SAAS,CAAE,IAAI,CACf,MAAM,CAAE,OACV,CACA,mCAAqB,CACnB,gBAAgB,CAAE,OAAO,CACzB,MAAM,CAAE,GAAG,CAAC,KAAK,CAAC,KAAK,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,CAC1C,OAAO,CAAE,GAAG,CAAC,IAAI,CACjB,SAAS,CAAE,IAAI,CACf,MAAM,CAAE,OACV,CACA,gCAAiB,MAAO,CACtB,gBAAgB,CAAE,OACpB"}'};function V(e,t){return t%2==0?parseInt(t/2)+1+". "+e.san:e.san}const W=p(((e,t,n,o)=>{new Q;let{history:i=[]}=t,{handleMove:a}=t,{handleUndo:l}=t,{handleRedo:c}=t,{currentIndex:A}=t,p=[];var f;function m(e){"ArrowLeft"===e.key&&l(),"ArrowRight"===e.key&&c()}function g(){p[A]&&p[A].scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"})}return r((()=>{window.addEventListener("keydown",m),g()})),f=()=>{window.removeEventListener("keydown",m),g()},s().$$.after_update.push(f),void 0===t.history&&n.history&&void 0!==i&&n.history(i),void 0===t.handleMove&&n.handleMove&&void 0!==a&&n.handleMove(a),void 0===t.handleUndo&&n.handleUndo&&void 0!==l&&n.handleUndo(l),void 0===t.handleRedo&&n.handleRedo&&void 0!==c&&n.handleRedo(c),void 0===t.currentIndex&&n.currentIndex&&void 0!==A&&n.currentIndex(A),e.css.add(z),`<div>${i!=[]?`<div class="move-list svelte-1pf9wc2">${d(i,((e,t)=>""+(t==A?`<button class="almost-invisible-on svelte-1pf9wc2"${u("this",p[t],0)}>${h(V(e,t))} </button>`:`<button class="almost-invisible svelte-1pf9wc2"${u("this",p[t],0)}>${h(V(e,t))} </button>`)))}</div>`:""}\n  <button>prev </button>\n  <button>next</button></div>`})),Z={code:".piece.svelte-1ulxvq5 img.svelte-1ulxvq5{width:100%;height:100%}",map:"{\"version\":3,\"file\":\"Piece.svelte\",\"sources\":[\"Piece.svelte\"],\"sourcesContent\":[\"<script>\\n  export let name = '_';\\n\\n  const images = {\\n    'k': 'https://upload.wikimedia.org/wikipedia/commons/f/f0/Chess_kdt45.svg',\\n    'q': 'https://upload.wikimedia.org/wikipedia/commons/4/47/Chess_qdt45.svg',\\n    'r': 'https://upload.wikimedia.org/wikipedia/commons/f/ff/Chess_rdt45.svg',\\n    'b': 'https://upload.wikimedia.org/wikipedia/commons/9/98/Chess_bdt45.svg',\\n    'n': 'https://upload.wikimedia.org/wikipedia/commons/e/ef/Chess_ndt45.svg',\\n    'p': 'https://upload.wikimedia.org/wikipedia/commons/c/c7/Chess_pdt45.svg',\\n    'K': 'https://upload.wikimedia.org/wikipedia/commons/4/42/Chess_klt45.svg',\\n    'Q': 'https://upload.wikimedia.org/wikipedia/commons/1/15/Chess_qlt45.svg',\\n    'R': 'https://upload.wikimedia.org/wikipedia/commons/7/72/Chess_rlt45.svg',\\n    'B': 'https://upload.wikimedia.org/wikipedia/commons/b/b1/Chess_blt45.svg',\\n    'N': 'https://upload.wikimedia.org/wikipedia/commons/7/70/Chess_nlt45.svg',\\n    'P': 'https://upload.wikimedia.org/wikipedia/commons/4/45/Chess_plt45.svg',\\n    '_': 'https://upload.wikimedia.org/wikipedia/commons/1/1d/No_image.svg'\\n  }\\n\\n  // Compute the image URL directly from the `name` prop\\n  $: image_url = images[name];\\n<\/script>\\n\\n<div class=\\\"piece\\\">\\n  <img src={image_url} alt={name} />\\n</div>\\n\\n<style>\\n  .piece img {\\n    width: 100%;\\n    height: 100%;\\n  }\\n</style>\\n\"],\"names\":[],\"mappings\":\"AA4BE,qBAAM,CAAC,kBAAI,CACT,KAAK,CAAE,IAAI,CACX,MAAM,CAAE,IACV\"}"},X=p(((e,t,n,o)=>{let i,{name:s="_"}=t;return void 0===t.name&&n.name&&void 0!==s&&n.name(s),e.css.add(Z),i={k:"https://upload.wikimedia.org/wikipedia/commons/f/f0/Chess_kdt45.svg",q:"https://upload.wikimedia.org/wikipedia/commons/4/47/Chess_qdt45.svg",r:"https://upload.wikimedia.org/wikipedia/commons/f/ff/Chess_rdt45.svg",b:"https://upload.wikimedia.org/wikipedia/commons/9/98/Chess_bdt45.svg",n:"https://upload.wikimedia.org/wikipedia/commons/e/ef/Chess_ndt45.svg",p:"https://upload.wikimedia.org/wikipedia/commons/c/c7/Chess_pdt45.svg",K:"https://upload.wikimedia.org/wikipedia/commons/4/42/Chess_klt45.svg",Q:"https://upload.wikimedia.org/wikipedia/commons/1/15/Chess_qlt45.svg",R:"https://upload.wikimedia.org/wikipedia/commons/7/72/Chess_rlt45.svg",B:"https://upload.wikimedia.org/wikipedia/commons/b/b1/Chess_blt45.svg",N:"https://upload.wikimedia.org/wikipedia/commons/7/70/Chess_nlt45.svg",P:"https://upload.wikimedia.org/wikipedia/commons/4/45/Chess_plt45.svg",_:"https://upload.wikimedia.org/wikipedia/commons/1/1d/No_image.svg"}[s],`<div class="piece svelte-1ulxvq5"><img${u("src",i,0)}${u("alt",s,0)} class="svelte-1ulxvq5">\n</div>`})),Y={code:".board.svelte-lz2d3f{display:grid;grid-template-columns:repeat(8, 1fr);grid-template-rows:repeat(8, 1fr);width:400px;height:400px;border:1px solid black}.chess-container.svelte-lz2d3f{display:flex;justify-content:center;align-items:flex-start}.cell.svelte-lz2d3f{display:flex;justify-content:center;align-items:center;width:100%;height:100%;min-width:48px;min-height:48px;max-width:48px;max-height:48px;border:1px solid black}.board-wrapper.svelte-lz2d3f{margin-right:16px}.black.svelte-lz2d3f{background-color:#b58863}.white.svelte-lz2d3f{background-color:#f0d9b5}",map:'{"version":3,"file":"Board.svelte","sources":["Board.svelte"],"sourcesContent":["<script>\\n    import MoveViewer from \\"./MoveViewer.svelte\\";\\n    import Piece from \'./Piece.svelte\'\\n    import {Chess} from \\"chess.js\\";\\n    import { writable } from \\"svelte/store\\";\\n    import { onMount, onDestroy } from \'svelte\';\\n    import { flip } from \\"svelte/animate\\";\\n\\n\\n\\n    export let startingPositionFEN = \\"rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1\\";\\n    export let pgn = \\"\\";\\n    export let debug = false;\\n\\n    let fen = \\"\\";\\n    let key = 0;\\n    let currentIndex = 0;\\n    let board = writable(fenToBoard(startingPositionFEN));\\n    let history = [];\\n    let boardValue;\\n    board.subscribe(value => {\\n        boardValue = value;\\n    });\\n    \\n   \\n    let chess = new Chess();\\n\\n    let letters = [\\"a\\", \\"b\\", \\"c\\", \\"d\\", \\"e\\", \\"f\\", \\"g\\", \\"h\\"];\\n    let numbers = [8, 7, 6, 5, 4, 3, 2, 1];\\n\\n    \\n    \\n    function validateFEN(fen) {\\n        const fenParts = fen.split(\\" \\");\\n        if (fenParts.length !== 6) {\\n          return false;\\n      }\\n\\n      const [position, activeColor, castling, enPassant, halfMove, fullMove] = fenParts;\\n\\n      // Check position\\n      const rows = position.split(\\"/\\");\\n      if (rows.length !== 8) {\\n        return false;\\n      }\\n\\n      for (const row of rows) {\\n        let rowCount = 0;\\n        for (const char of row) {\\n          if (isNaN(parseInt(char))) {\\n            if (!\\"prnbqkPRNBQK\\".includes(char)) {\\n              return false;\\n            }\\n            rowCount += 1;\\n          } else {\\n            rowCount += parseInt(char);\\n          }\\n        }\\n        if (rowCount !== 8) {\\n          return false;\\n        }\\n      }\\n\\n      // Check active color\\n      if (![\\"w\\", \\"b\\"].includes(activeColor)) {\\n        return false;\\n      }\\n\\n      // Check castling availability\\n      if (!/^(KQ?k?q?|Qk?q?|kq?|q|-)$/.test(castling)) {\\n        return false;\\n      }\\n\\n      // Check en passant target square\\n      if (!/^(?:(?:[a-h][36])|-)$/.test(enPassant)) {\\n        return false;\\n      }\\n\\n      // Check halfmove clock and fullmove number\\n      if (isNaN(halfMove) || isNaN(fullMove)) {\\n        return false;\\n      }\\n\\n      return true;\\n    }\\n\\n  /**\\n   * Loads a PGN string and updates the board with the resulting position.\\n   */\\n    function loadFEN() {\\n      if (validateFEN(fen)) {\\n        chess.load(fen);\\n        board.set(fenToBoard(fen));\\n        console.log(board);\\n        console.log(boardValue);\\n\\n        key += 1;\\n      } else {\\n        console.error(\\"Invalid FEN:\\", fen);\\n      }\\n    }\\n\\n\\n  /**\\n   * Parses a PGN string into an array of moves.\\n   * @param {string} pgn - The PGN string.\\n   * @returns {Array<string>} An array of moves.\\n   */\\n  function loadPGN() {\\n    chess.loadPgn(pgn); // Load the PGN using chess.js\\n    history = chess.history({ verbose: true }); // Get the move history\\n    currentIndex = history.length; // Set the current index to the end of the history\\n    console.log(history)\\n    updateBoard(history); // Update the board using the move history\\n  \\n  }\\n\\n  /**\\n   * Converts a FEN string to a 2D array representing the board.\\n   * @param {string} fen - The FEN string.\\n   * @returns {Array<Array<string>>} A 2D array representing the board.\\n   */\\n  function fenToBoard(fen) {\\n    const [position] = fen.split(\\" \\");\\n    const rows = position.split(\\"/\\");\\n    const board = rows.map((row) => {\\n        const newRow = [];\\n        for (const char of row) {\\n        if (isNaN(parseInt(char))) {\\n            newRow.push(char);\\n        } else {\\n            newRow.push(...Array(parseInt(char)).fill(\'_\'));\\n        }\\n        }\\n        return newRow;\\n    });\\n    return board;\\n  }\\n\\n  function handleMove(moveIndex, history) {\\n    // Reset the chess object to the initial position\\n    chess.reset();\\n\\n    // Apply each move in the history array up to moveIndex (exclusive)\\n    for (let i = 0; i < moveIndex; i++) {\\n      const move = history[i];\\n      const result = chess.move(move);\\n      if (!result) {\\n        console.error(\\"Invalid move:\\", move);\\n        break;\\n      }\\n    }\\n    currentIndex = moveIndex;\\n\\n    // Update the board\'s position based on the chess object\'s FEN\\n    board.set(fenToBoard(chess.fen()));\\n  }\\n\\n  function handleUndo() {\\n    currentIndex -= 1;\\n    if (currentIndex < 0) {\\n      currentIndex = 0;\\n    }\\n    handleMove(currentIndex, history);\\n  }\\n\\n  function handleRedo() {\\n    currentIndex += 1;\\n    if (currentIndex > history.length) {\\n      currentIndex = history.length;\\n    }\\n    handleMove(currentIndex, history);\\n  }\\n\\n  function handleGlobalKeyDown(event) {\\n    if (event.key === \'ArrowLeft\') {\\n      handleUndo();\\n    }\\n    if (event.key === \'ArrowRight\') {\\n      handleRedo();\\n    }\\n  }\\n\\n\\n\\n  onMount(() => {\\n    window.addEventListener(\'keydown\', handleGlobalKeyDown);\\n    loadPGN(pgn);\\n  });\\n  onDestroy(() => {\\n    window.removeEventListener(\'keydown\', handleGlobalKeyDown);\\n  });\\n\\n  /**\\n   * Updates the board position based on an array of moves.\\n   * @param {Array<string>} moves - An array of moves to apply.\\n   */\\n\\n   function updateBoard(moves) {\\n    // Reset the chess object to the initial position\\n    chess.reset();\\n\\n    if (!Array.isArray(moves)) {\\n      console.error(\\"Invalid moves array:\\", moves);\\n      return;\\n    }\\n\\n    // Apply each move in the moves array\\n    for (const move of moves) {\\n      const result = chess.move(move);\\n      if (!result) {\\n        console.error(\\"Invalid move:\\", move);\\n        break;\\n      }\\n    }\\n\\n    // Update the board\'s position based on the chess object\'s FEN\\n    const newFen = chess.fen();\\n    board.set(fenToBoard(newFen));\\n  }\\n\\n  \\n  $: {\\n    boardValue = $board;\\n  }\\n<\/script>\\n  \\n<style>\\n  .board {\\n    display: grid;\\n    grid-template-columns: repeat(8, 1fr);\\n    grid-template-rows: repeat(8, 1fr);\\n    width: 400px;\\n    height: 400px;\\n    border: 1px solid black;\\n  }\\n  .chess-container {\\n\\t  display: flex;\\n\\t  justify-content: center;\\n\\t  align-items: flex-start;\\n\\t}\\n  .cell {\\n    display: flex;\\n    justify-content: center;\\n    align-items: center;\\n    width: 100%;\\n    height: 100%;\\n    min-width: 48px;\\n    min-height: 48px;\\n    max-width: 48px;\\n    max-height: 48px;\\n    border: 1px solid black;\\n  }\\n  .board-wrapper {\\n    margin-right: 16px; /* Adjust this value to set the spacing between the board and the move viewer */\\n  }\\n  .black {\\n    background-color: #b58863;\\n  }\\n\\n  .white {\\n    background-color: #f0d9b5;\\n  }\\n</style>\\n  \\n{#if debug}\\n  <input bind:value={fen} placeholder=\\"Enter FEN\\" />\\n  <button on:click={loadFEN}>Load FEN</button>\\n    \\n\\n  <input bind:value={pgn} placeholder=\\"Enter PGN\\" />\\n  <button on:click={loadPGN}>Load PGN</button>\\n{/if}\\n\\n<div class=\\"chess-container\\">\\n<div class=\\"board-wrapper\\">\\n  <div class=\\"board\\">\\n    {#each numbers as number, row}\\n      {#each letters as letter, col}\\n        <div\\n          class=\\"cell {col % 2 === row % 2 ? \'white\' : \'black\'}\\"\\n          data-coordinate=\\"{letter}{number}\\"\\n          key=\\"{letter}{number}{boardValue[row][col]}\\"\\n          transition:flip={{ duration: 1000 }} \\n        >\\n      <Piece name={boardValue[row][col]}/>\\n        </div>\\n\\n      {/each}\\n    {/each}\\n  </div>\\n</div>\\n<MoveViewer {history} {handleMove} {handleUndo} {handleRedo} {currentIndex}/>\\n\\n</div>\\n"],"names":[],"mappings":"AAoOE,oBAAO,CACL,OAAO,CAAE,IAAI,CACb,qBAAqB,CAAE,OAAO,CAAC,CAAC,CAAC,GAAG,CAAC,CACrC,kBAAkB,CAAE,OAAO,CAAC,CAAC,CAAC,GAAG,CAAC,CAClC,KAAK,CAAE,KAAK,CACZ,MAAM,CAAE,KAAK,CACb,MAAM,CAAE,GAAG,CAAC,KAAK,CAAC,KACpB,CACA,8BAAiB,CAChB,OAAO,CAAE,IAAI,CACb,eAAe,CAAE,MAAM,CACvB,WAAW,CAAE,UACf,CACC,mBAAM,CACJ,OAAO,CAAE,IAAI,CACb,eAAe,CAAE,MAAM,CACvB,WAAW,CAAE,MAAM,CACnB,KAAK,CAAE,IAAI,CACX,MAAM,CAAE,IAAI,CACZ,SAAS,CAAE,IAAI,CACf,UAAU,CAAE,IAAI,CAChB,SAAS,CAAE,IAAI,CACf,UAAU,CAAE,IAAI,CAChB,MAAM,CAAE,GAAG,CAAC,KAAK,CAAC,KACpB,CACA,4BAAe,CACb,YAAY,CAAE,IAChB,CACA,oBAAO,CACL,gBAAgB,CAAE,OACpB,CAEA,oBAAO,CACL,gBAAgB,CAAE,OACpB"}'};function J(e){const[t]=e.split(" ");return t.split("/").map((e=>{const t=[];for(const n of e)isNaN(parseInt(n))?t.push(n):t.push(...Array(parseInt(n)).fill("_"));return t}))}const H=p(((e,n,o,i)=>{let a,l,{startingPositionFEN:A="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1"}=n,{pgn:p=""}=n,{debug:m=!1}=n,g=0,v=function(e,n=t){let o;const i=new Set;function s(t){if(s=t,((n=e)!=n?s==s:n!==s||n&&"object"==typeof n||"function"==typeof n)&&(e=t,o)){const t=!f.length;for(const t of i)t[1](),f.push(t,e);if(t){for(let e=0;e<f.length;e+=2)f[e][0](f[e+1]);f.length=0}}var n,s}return{set:s,update:function(t){s(t(e))},subscribe:function(r,a=t){const l=[r,a];return i.add(l),1===i.size&&(o=n(s)||t),r(e),()=>{i.delete(l),0===i.size&&o&&(o(),o=null)}}}}(J(A));l=function(e,...n){if(null==e)return t;const o=e.subscribe(...n);return o.unsubscribe?()=>o.unsubscribe():o}(v,(e=>a=e));let C,_=[];v.subscribe((e=>{C=e}));let b=new Q,k=["a","b","c","d","e","f","g","h"];function w(){b.loadPgn(p),_=b.history({verbose:!0}),g=_.length,console.log(_),function(e){if(b.reset(),!Array.isArray(e))return void console.error("Invalid moves array:",e);for(const t of e){if(!b.move(t)){console.error("Invalid move:",t);break}}const t=b.fen();v.set(J(t))}(_)}function E(e,t){b.reset();for(let n=0;n<e;n++){const e=t[n];if(!b.move(e)){console.error("Invalid move:",e);break}}g=e,v.set(J(b.fen()))}function y(){g-=1,g<0&&(g=0),E(g,_)}function I(){g+=1,g>_.length&&(g=_.length),E(g,_)}function x(e){"ArrowLeft"===e.key&&y(),"ArrowRight"===e.key&&I()}var S;return r((()=>{window.addEventListener("keydown",x),w()})),S=()=>{window.removeEventListener("keydown",x)},s().$$.on_destroy.push(S),void 0===n.startingPositionFEN&&o.startingPositionFEN&&void 0!==A&&o.startingPositionFEN(A),void 0===n.pgn&&o.pgn&&void 0!==p&&o.pgn(p),void 0===n.debug&&o.debug&&void 0!==m&&o.debug(m),e.css.add(Y),C=a,l(),`${m?`<input placeholder="Enter FEN"${u("value","",0)}>\n  <button>Load FEN</button>\n    \n\n  <input placeholder="Enter PGN"${u("value",p,0)}>\n  <button>Load PGN</button>`:""}\n\n<div class="chess-container svelte-lz2d3f"><div class="board-wrapper svelte-lz2d3f"><div class="board svelte-lz2d3f">${d([8,7,6,5,4,3,2,1],((t,n)=>`${d(k,((o,i)=>`<div class="${"cell "+h(i%2==n%2?"white":"black",!0)+" svelte-lz2d3f"}" data-coordinate="${h(o,!0)+h(t,!0)}" key="${h(o,!0)+h(t,!0)+h(C[n][i],!0)}">${c(X,"Piece").$$render(e,{name:C[n][i]},{},{})}\n        </div>`))}`))}</div></div>\n${c(W,"MoveViewer").$$render(e,{history:_,handleMove:E,handleUndo:y,handleRedo:I,currentIndex:g},{},{})}</div>`})),ee=H;return e.Board=H,e.PgnReader=ee,Object.defineProperty(e,"__esModule",{value:!0}),e}({});
//# sourceMappingURL=bundle.js.map
